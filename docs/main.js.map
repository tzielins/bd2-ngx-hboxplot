{"version":3,"file":"main.js","mappings":"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","sources":["./projects/bd2-ngx-hboxplot-demo/src/app/app.component.ts","./projects/bd2-ngx-hboxplot-demo/src/app/app.component.html","./projects/bd2-ngx-hboxplot-demo/src/app/app.module.ts","./projects/bd2-ngx-hboxplot-demo/src/environments/environment.ts","./projects/bd2-ngx-hboxplot-demo/src/main.ts","./projects/bd2-ngx-hboxplot/src/lib/d3service/d3.service.ts","./projects/bd2-ngx-hboxplot/src/lib/d3service/index.ts","./projects/bd2-ngx-hboxplot/src/lib/hbox-plot/hbox-plot.dom.ts","./projects/bd2-ngx-hboxplot/src/lib/hbox-utils/box-dom.ts","./projects/bd2-ngx-hboxplot/src/lib/hbox-utils/box-util.ts","./projects/bd2-ngx-hboxplot/src/lib/hbox-utils/color-palette.ts","./projects/bd2-ngx-hboxplot/src/lib/hbox-utils/smart-rounding.ts","./projects/bd2-ngx-hboxplot/src/lib/hbox-plot/hbox-plot.component.ts","./projects/bd2-ngx-hboxplot/src/lib/bd2-ngx-hboxplot.module.ts","./projects/bd2-ngx-hboxplot/src/public-api.ts","./projects/bd2-ngx-hboxplot/src/bd2-ngx-hboxplot.ts"],"sourcesContent":["import { Component } from '@angular/core';\nimport {interval, of, Subscription} from 'rxjs';\nimport {delay, take} from 'rxjs/operators';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent {\n  title = 'Vertical Box Plot';\n\n  data: number[][] = [];\n  removed: number[] = [];\n\n  testData: number[][];\n\n  isHidden = false;\n\n  labels: string[];\n\n  labelsOn = 'always';\n\n  sorted = 'median';\n\n  private ci = 0;\n\n  constructor() {\n    this.testData = [\n      [20, 21, 23, 24, 25],\n      [18, 18.5, 25.5, 25, 26, 22.8, 25.8, 26, 25.1, 26.8],\n      [30],\n      [20, 20.5, 20.6],\n      [28, 29.7, 28.5],\n      [21.5, 29.7, 28.4, 29.5, 24, 24.1, 25.9, 24.7, 23.7, 24.3, 23.4, 24.5, 22.5, 23.7, 23.9, 23.5],\n      []\n    ];\n\n    const nr = Math.random() * 15 + 1;\n    const row = [];\n    for (let i = 0; i < nr; i++) {\n      row.push(Math.random() * 10 + 20);\n    }\n    this.testData.push(row);\n\n    // this.generateData();\n    this.generateData();\n  }\n\n  toggleRemoved() {\n    if (this.removed.length === 0) {\n      this.removed = [0, 3];\n    } else {\n      this.removed = [];\n    }\n  }\n\n  toggleHidden() {\n    this.isHidden = !this.isHidden;\n  }\n\n  toggleSorted() {\n    if (this.sorted === 'median') {\n      this.sorted = 'label';\n    } else if (this.sorted === 'label') {\n      this.sorted = 'none';\n    } else {\n      this.sorted = 'median';\n    }\n\n  }\n\n  toggleLabels() {\n    if (this.labelsOn === 'always') {\n      this.labelsOn = 'trigger';\n    } else if (this.labelsOn === 'trigger') {\n      this.labelsOn = null;\n    } else {\n      this.labelsOn = 'always';\n    }\n  }\n\n  // for testing fast changing data\n  generateDelayedData() {\n    let s: Subscription;\n    s = interval(1000).pipe(\n      take(3)\n    ).subscribe( v => this.generateDataInner(4), err => {}, () => {\n      if (s) { s.unsubscribe(); }\n    });\n  }\n\n  generateData() {\n    // this.generateDataInner(2);\n    this.generateDelayedData();\n  }\n\n  generateDataInner(nrBase = 1) {\n    this.ci++;\n    //\n    const nr = nrBase + Math.random() * 15; // (1 + * 15)\n    // console.log(\"TD: \" + this.testData.length);\n\n    const d = [];\n    for (let i = 0; i < nr; i++) {\n      // let ix = i % this.testData.length;\n      const ix = Math.round(Math.random() * (this.testData.length - 1));\n      // console.log(\"I \" + ix);\n      let row = this.testData[ix];\n      const base = -3 + Math.random() * 8;\n\n      row = row.map(v => v + base);\n      /*if (ix === 1) {\n       if (Math.random() < 0.5) {\n       row[0] = row[row.length - 1];\n       }\n       }*/\n      d.push(row);\n\n    }\n\n    const LET = 'ABCDEFGHIJKLMN abcdef';\n    const labels = d.map((v, ix) => {\n\n      const s = Math.random() * 30 + 3;\n      let label = ''; //\n      for (let i = 0; i < s; i++) {\n        label += LET[Math.round(Math.random() * (LET.length - 1))];\n      }\n      label += ' ' + (ix + 1) + '. ';\n\n      return label;\n    });\n\n    this.data = d;\n    this.labels = labels;\n  }\n\n\n  detection() {\n    this.ci++;\n    console.log('Change detection ' + this.ci);\n    return 'Change detection';\n  }\n}\n","<div class=\"container central-area\">\n  <div class=\"row\">\n\n    <div class=\"col-md-12\">\n      <h1>\n        {{title}}\n      </h1>\n\n      <div>\n        <p>\n          Simple demo of horizontal box plot. V 1.11.0\n        </p>\n        <p>Generated triggers generation of multiple data sets to illustrate changes.</p>\n      </div>\n      <hr>\n    </div>\n  </div>\n\n  <div class=\"row\">\n    <div class=\"col-sm-3\">\n      <div class=\"form-group\">\n        <label class=\"btn btn-primary btn-sm\"  (click)=\"toggleRemoved()\">Toggle removed:</label> <a (click)=\"toggleRemoved()\">\n        [{{removed}}]</a>\n      </div>\n\n      <div class=\"form-group\">\n        <a class=\"btn btn-primary btn-sm\" (click)=\"generateData()\">generate</a>\n      </div>\n      <div class=\"form-group\">\n        <label class=\"btn btn-primary btn-sm\"  (click)=\"toggleHidden()\">Toggle Hidden: {{isHidden}}</label><br>\n        <label class=\"btn btn-primary btn-sm\"  (click)=\"toggleLabels()\">Toggle Labels: {{labelsOn}}</label><br>\n        <label class=\"btn btn-primary btn-sm\" (click)=\"toggleSorted()\">Toggle Sorted: {{sorted}}</label><br>\n\n      </div>\n\n    </div>\n    <div class=\"col-sm-9\">\n\n      <div [hidden]=\"isHidden\">\n        <bd2-ngx-hbox-plot\n          [data]=\"data\" [labels]=\"labels\" [hidden]=\"isHidden\" [labelsOn]=\"labelsOn\"\n          [removed]=\"removed\" [sorted]=\"sorted\"\n        >\n        </bd2-ngx-hbox-plot>\n      </div>\n      {{detection()}}\n    </div>\n    <div class=\"col-sm-12\">\n      <div class=\"form-group\">\n\n        <label>Data:</label>\n        <ul class=\"list-unstyled\" style=\"margin: 1em;\">\n          <li *ngFor=\"let row of data\">[{{row}}],</li>\n        </ul>\n      </div>\n\n    </div>\n  </div>\n</div>\n","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\n\nimport { AppComponent } from './app.component';\nimport {BD2NgxHBoxplotModule} from 'bd2-ngx-hboxplot';\n\n@NgModule({\n  declarations: [\n    AppComponent\n  ],\n  imports: [\n    BrowserModule,\n    BD2NgxHBoxplotModule\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/plugins/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n","import * as d3lib from 'd3';\r\n\r\nexport type D3 = typeof d3lib;\r\nexport const d3 = d3lib;\r\n\r\n/**\r\n D3 integration was originally based on the code for npm library: d3-ng2-service\r\n by Tom Wanzek, https://github.com/tomwanzek/d3-ng2-service.\r\n\r\n That package was used during developement and then converted into inline service\r\n to reduce the dependencies and boundle size.\r\n\r\n At some point, I moved to to simpler dependency on d3:\r\n npm install --save d3\r\n npm install --save-dev @types/d3\r\n\r\n and removed the parts from d3-modules.ts as they were causing errors\r\n (not sure how to fix them and also one dependency is easier to maintain).\r\n */\r\n","export * from './d3.service';\r\n\r\n/*\r\n// that has been removed after importing a single d3 dependency\r\n\r\nexport {\r\n  // d3-array\r\n  Bin,\r\n  Bisector,\r\n  HistogramGenerator,\r\n  Numeric,\r\n  ThresholdArrayGenerator,\r\n  ThresholdCountGenerator,\r\n  // d3-axis\r\n  Axis,\r\n  AxisContainerElement,\r\n  AxisScale,\r\n  AxisTimeInterval,\r\n  // d3-scale\r\n  InterpolatorFactory,\r\n  ScaleBand,\r\n  ScaleIdentity,\r\n  ScaleLinear,\r\n  ScaleLogarithmic,\r\n  ScaleOrdinal,\r\n  ScalePoint,\r\n  ScalePower,\r\n  ScaleQuantile,\r\n  ScaleQuantize,\r\n  ScaleSequential,\r\n  ScaleThreshold,\r\n  ScaleTime,\r\n\r\n  // d3-selection\r\n  ArrayLike,\r\n  BaseEvent,\r\n  BaseType,\r\n  ContainerElement,\r\n  EnterElement,\r\n  Local,\r\n  NamespaceLocalObject,\r\n  NamespaceMap,\r\n  Selection,\r\n  SelectionFn,\r\n  TransitionLike,\r\n  ValueFn,\r\n  // d3-selection-multi\r\n  ValueMap,\r\n  // d3-shape\r\n  Arc,\r\n  Area,\r\n  DefaultArcObject,\r\n  Line,\r\n  Pie,\r\n  PieArcDatum,\r\n  RadialArea,\r\n  RadialLine,\r\n  Series,\r\n  SeriesPoint,\r\n  Stack,\r\n  Symbol,\r\n  SymbolType,\r\n  // d3-transition\r\n  Transition\r\n} from './d3-modules';\r\n\r\n\r\n */\r\n","// import {Transition} from 'd3-transition';\nimport {Axis} from 'd3-axis';\nimport {ScaleBand, ScaleLinear} from 'd3-scale';\nimport {Selection, Transition} from 'd3';\n\n\nexport class LookAndFeel {\n\n  vMargin = 25;\n  hMarginL = 20;\n  hMarginR = 15;\n  rowWidth = 30;\n  rowGap = 0.2;\n\n  transitionTime = 600;\n\n  boxStrokeWidth = '2px';\n  boxFillOpacity = 0.35;\n  meanStrokeWidth = '4px';\n\n  labelFont = '12px';\n  labelFillOpacity = 0.35;\n  backLabelOpacity = 0.30;\n\n  backdropColor = 'white';\n  backdropOpacity = 1;\n\n  whiskerStrokeWidth = '1px';\n\n  outliersStrokeWidth = '1px';\n  outliersCircleRadius = 3;\n  outliersFillOpacity = 0.4;\n}\n\n\nexport let defualtLookAndFeel: () => LookAndFeel = function() {\n  return new LookAndFeel();\n};\n\nexport class GraphicContext {\n\n  /*transitionTime: number;\n\n   get transitionOn(): boolean {\n   return (this.transitionTime && this.transitionTime > 0);\n   };*/\n\n  transitionOn: boolean;\n  transition: Transition<any, any, any, any>;\n\n  workspaceWidth: number;\n  workspaceHeight: number;\n\n  axisWrapper: Selection<SVGGElement, any, null, undefined>;\n  xScale: ScaleLinear<number, number>;\n  xTopAxis: Axis<number | { valueOf(): number }>;\n  xBottomAxis: Axis<number | { valueOf(): number }>;\n\n  yScale: ScaleBand<string>;\n  yLeftAxis: Axis<string>;\n  yRightAxis: Axis<string>;\n\n  palette: string[];\n\n  dataWrapper: Selection<SVGGElement, any, null, undefined>;\n\n  tooltipWrapper: Selection<SVGGElement, any, null, undefined>;\n  tooltipText: Selection<SVGGElement, any, null, undefined>;\n  tooltipBox: Selection<SVGGElement, any, null, undefined>;\n\n  labelsWrapper: Selection<SVGGElement, any, null, undefined>;\n  backLabelsWrapper: Selection<SVGGElement, any, null, undefined>;\n  labelsTimers = [];\n}\n\nexport function offsetScaleValue(x: number, pixOffset: number, scale: ScaleLinear<number, number>) {\n  const r = scale.range();\n  const pos = scale(x) + pixOffset;\n  if (pos < r[0]) {\n    return r[0];\n  } else if (pos > r[1]) {\n    return r[1];\n  }\n  return pos;\n}\n\n\n\n","\nexport class BoxDefinition {\n  median: number;\n  mean: number;\n  fstQnt: number;\n  thrdQnt: number;\n  lowWskr: number;\n  highWskr: number;\n  outliers: number[] = [];\n  ix: number;\n  key: string;\n  label: string;\n  color: string;\n  hidden: boolean;\n}\n","import {BoxDefinition} from './box-dom';\nimport {d3} from '../d3service';\n\nexport class BoxUtil {\n\n  dataToBoxes(data: number[][]): BoxDefinition[] {\n    if (!data) {\n      return [];\n    }\n\n\n    return data.map((v, ix) => {\n      const b = this.datumToBox(v);\n      b.ix = ix;\n      b.key = (ix + 1) + '.';\n      return b;\n    });\n  }\n\n  datumToBox(data: number[]): BoxDefinition {\n\n    const box = new BoxDefinition();\n    if (!data || data.length === 0) {\n      return box;\n    }\n\n    data = data.sort(d3.ascending);\n    box.mean = d3.mean(data);\n    box.median = d3.median(data);\n    box.fstQnt = d3.quantile(data, 0.25);\n    box.thrdQnt = d3.quantile(data, 0.75);\n\n    const iqr = 1.5 * (box.thrdQnt - box.fstQnt);\n    box.lowWskr = box.fstQnt - iqr;\n    box.highWskr = box.thrdQnt + iqr;\n\n    for (let i = 0; i < data.length; i++) {\n      if (data[i] >= box.lowWskr) {\n        box.lowWskr = data[i];\n        break;\n      }\n    }\n\n    for (let i = data.length - 1; i >= 0; i--) {\n      if (data[i] <= box.highWskr) {\n        box.highWskr = data[i];\n        break;\n      }\n    }\n\n\n    box.outliers = data.filter(v => (v < box.lowWskr || v > box.highWskr));\n    return box;\n  }\n\n  mockEmptyValues(boxes: BoxDefinition[], missingVal: number) {\n    boxes.forEach(box => {\n      if (box.mean === undefined || box.mean === null) {\n        box.mean = missingVal;\n        box.median = missingVal;\n        box.fstQnt = missingVal;\n        box.thrdQnt = missingVal;\n        box.lowWskr = missingVal;\n        box.highWskr = missingVal;\n      }\n    });\n  }\n}\n","\r\nexport class BD2ColorPalette {\r\n\r\n  static schemeCategory10 = [\r\n    '#1f77b4',\r\n    '#ff7f0e',\r\n    '#2ca02c',\r\n    '#d62728',\r\n    '#9467bd',\r\n    '#8c564b',\r\n    '#e377c2',\r\n    '#7f7f7f',\r\n    '#bcbd22',\r\n    '#17becf'\r\n  ];\r\n\r\n  static schemeCategory20 = [\r\n'#1f77b4'\r\n, '#aec7e8'\r\n, '#ff7f0e'\r\n, '#ffbb78'\r\n, '#2ca02c'\r\n, '#98df8a'\r\n, '#d62728'\r\n, '#ff9896'\r\n, '#9467bd'\r\n, '#c5b0d5'\r\n, '#8c564b'\r\n, '#c49c94'\r\n, '#e377c2'\r\n, '#f7b6d2'\r\n, '#7f7f7f'\r\n, '#c7c7c7'\r\n, '#bcbd22'\r\n, '#dbdb8d'\r\n, '#17becf'\r\n, '#9edae5'];\r\n\r\n  static extendPalette(palette: string[] | ReadonlyArray<string>, size: number): string[] {\r\n\r\n    if (!palette || palette.length === 0) {\r\n      palette = ['black'];\r\n    }\r\n\r\n    const out = [];\r\n    for (let i = 0; i < size; i++) {\r\n      out.push(palette[i % palette.length]);\r\n    }\r\n    return out;\r\n\r\n  }\r\n\r\n  static palette(size: number): string[] {\r\n    // if (true) return BD2ColorPalette.extendPalette(['#1f77b4'], size);\r\n    if (size <= BD2ColorPalette.schemeCategory10.length) {\r\n      return BD2ColorPalette.extendPalette(BD2ColorPalette.schemeCategory10, size);\r\n    } else {\r\n      return BD2ColorPalette.extendPalette(BD2ColorPalette.schemeCategory20, size);\r\n    }\r\n\r\n  }\r\n}\r\n","\r\nexport class SmartRounder {\r\n\r\n  static round(value: number, base?: number): number {\r\n\r\n    base = base || value;\r\n    base = Math.abs(base);\r\n\r\n    if (base < 0.01) {\r\n      return value;\r\n    }\r\n\r\n    if (base < 1) {\r\n      return Math.round(value * 10000) / 10000;\r\n    }\r\n\r\n    if (base < 1000) {\r\n      return Math.round(value * 100) / 100;\r\n    }\r\n    return Math.round(value);\r\n  }\r\n\r\n\r\n}\r\n","import {\r\n  Component, OnInit, Input, AfterViewInit, OnChanges, OnDestroy, NgZone, ChangeDetectorRef,\r\n  ElementRef, SimpleChanges, ChangeDetectionStrategy, EventEmitter, Output\r\n} from '@angular/core';\r\nimport {D3, d3} from '../d3service';\r\n\r\nimport {Selection} from 'd3';\r\nimport {defualtLookAndFeel, GraphicContext, LookAndFeel, offsetScaleValue} from './hbox-plot.dom';\r\nimport {BoxDefinition} from '../hbox-utils/box-dom';\r\nimport {BoxUtil} from '../hbox-utils/box-util';\r\nimport {BD2ColorPalette} from '../hbox-utils/color-palette';\r\nimport {SmartRounder} from '../hbox-utils/smart-rounding';\r\n\r\n\r\n\r\n\r\n\r\n@Component({\r\n  selector: 'bd2-ngx-hbox-plot',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  template: `\r\n    <div class=\"hbox-plot\" [hidden]=\"hidden\"></div>\r\n  `,\r\n  styles: [\r\n      `\r\n      :host ::ng-deep .axisWrapper path {\r\n        stroke: gray;\r\n      }\r\n\r\n      :host ::ng-deep .axisWrapper line {\r\n        stroke: gray;\r\n      }\r\n\r\n      :host ::ng-deep .axisWrapper text {\r\n        fill: gray;\r\n      }\r\n    `\r\n  ]\r\n})\r\nexport class HBoxPlotComponent implements OnInit, AfterViewInit, OnChanges, OnDestroy {\r\n\r\n  /**\r\n   * Necessary to control hiding of the element, otherwise the BBoxes are not defined and labels\r\n   * were not rendered in correct places.\r\n   *\r\n   */\r\n  @Input()\r\n  hidden = false;\r\n\r\n\r\n  @Input()\r\n  data: number[][];\r\n\r\n  @Input()\r\n  removed: number[] = [];\r\n\r\n  @Input()\r\n  domain: number[] = [17, 36];\r\n\r\n  @Input()\r\n  palette: string[] = [];\r\n\r\n  @Input()\r\n  labels: string[] = [];\r\n\r\n  @Input()\r\n  labelsOn = 'always'; // trigger //null\r\n\r\n  @Input()\r\n  lookAndFeel = defualtLookAndFeel();\r\n\r\n  @Input() // median, label, null\r\n  set sorted(sorting: string) {\r\n\r\n    if (sorting === 'median') {\r\n      this.sortFunction = (b1: BoxDefinition, b2: BoxDefinition) => b1.median - b2.median;\r\n    } else if (sorting === 'label') {\r\n      // console.log(\"N\",navigator.language);\r\n      /*if (navigator.language) {\r\n       this.sortFunction = (b1: BoxDefinition, b2: BoxDefinition) =>\r\n       b1.label.localeCompare(b2.label, navigator.language, {sensitivity: 'case'});\r\n       } else {\r\n       this.sortFunction = (b1: BoxDefinition, b2: BoxDefinition) => b1.label.localeCompare(b2.label);\r\n       };*/\r\n      this.sortFunction = (b1: BoxDefinition, b2: BoxDefinition) => {\r\n        if (b1.label === b2.label) {\r\n          return 0;\r\n        }\r\n        if (b1.label < b2.label) {\r\n          return -1;\r\n        }\r\n        return 1;\r\n      };\r\n    } else {\r\n      this.sortFunction = (b1: BoxDefinition, b2: BoxDefinition) => b1.ix - b2.ix;\r\n    }\r\n  }\r\n\r\n\r\n  sortChanged = false;\r\n\r\n  @Output()\r\n  colors = new EventEmitter<string[]>();\r\n\r\n  private d3: D3;\r\n  private parentNativeElement: any;\r\n  private d3Svg: Selection<SVGSVGElement, any, null, undefined>;\r\n  // private removedSVG: Selection<SVGSVGElement, any, null, undefined>;\r\n\r\n  private mainPane: Selection<SVGGElement, any, null, undefined>;\r\n\r\n  private graphicContext = new GraphicContext();\r\n  private boxUtil = new BoxUtil();\r\n\r\n  sortFunction = function(b1: BoxDefinition, b2: BoxDefinition) {\r\n    return b1.ix - b2.ix;\r\n  };\r\n\r\n\r\n  constructor(private ngZone: NgZone, private changeDetectorRef: ChangeDetectorRef, element: ElementRef) {\r\n    this.d3 = d3;\r\n    this.parentNativeElement = element.nativeElement;\r\n\r\n  }\r\n\r\n  /**\r\n   * It is detached from angular to prevent unnecessary change detection\r\n   */\r\n  ngAfterViewInit() {\r\n    this.changeDetectorRef.detach();\r\n    // console.log(\"AFI\");\r\n  }\r\n\r\n  /**\r\n   * Explicit triggers re-drawing as need to have all the parameters set (so will not redrawn if data came frist and domain later)\r\n   * @param changes\r\n   */\r\n  ngOnChanges(changes: SimpleChanges) {\r\n\r\n    // console.log(\"Changes\", changes);\r\n\r\n    // otherwise the hidden on inner div was not updated\r\n    this.changeDetectorRef.detectChanges();\r\n\r\n\r\n    this.initSVG();\r\n\r\n    // this.handleHiding();\r\n\r\n    if (!this.data) {\r\n      return;\r\n    }\r\n\r\n    this.sortChanged = changes.sorted !== undefined;\r\n\r\n    if (!this.hidden) {\r\n      this.updatePlot();\r\n    }\r\n  }\r\n\r\n  isDataUpdate(changes: any): boolean {\r\n\r\n    return (changes.data || changes.removed || changes.domain || changes.palette || changes.labels );\r\n  }\r\n\r\n  initSVG() {\r\n    if (!this.d3Svg) {\r\n      const d3ParentElement = this.d3.select(this.parentNativeElement);\r\n      this.d3Svg = d3ParentElement.select('.hbox-plot').append<SVGSVGElement>('svg');\r\n      this.d3Svg.attr('width', '0');\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n\r\n    if (this.parentNativeElement !== null) {\r\n\r\n\r\n    } else {\r\n      console.error('Missing parrent element for the component');\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.d3Svg && this.d3Svg.empty && !this.d3Svg.empty()) {\r\n      this.d3Svg.selectAll('*').remove();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Only for testing\r\n   * @param context\r\n   */\r\n  testGraphicContext(context: GraphicContext) {\r\n    this.graphicContext = context;\r\n  }\r\n\r\n  /* Not needed any more, the hidding is achieved by simple div hidden attribute\r\n   // and the problem with labels background rendering is solved using delayed rendering with a timer.\r\n   handleHiding() {\r\n   if (this.hidden) {\r\n   this.removed = this.d3Svg.remove();\r\n   } else {\r\n   if (this.removed) {\r\n   this.d3.select(this.parentNativeElement)\r\n   .select('.hbox-plot')\r\n   .append(() => this.d3Svg.node());\r\n   this.removed = undefined;\r\n   }\r\n   }\r\n\r\n   }*/\r\n\r\n  updatePlot() {\r\n\r\n    // this.graphicContext.transitionTime = this.lookAndFeel.transitionTime;\r\n\r\n    if (this.lookAndFeel.transitionTime > 0) {\r\n      this.graphicContext.transitionOn = true;\r\n      this.ngZone.runOutsideAngular(() => {\r\n        this.graphicContext.transition = (this.d3 as any).transition().duration(this.lookAndFeel.transitionTime);\r\n      });\r\n    } else {\r\n      this.graphicContext.transitionOn = false;\r\n      this.graphicContext.transition = undefined;\r\n    }\r\n\r\n    this.graphicContext = this.updatePalette(this.data, this.palette, this.graphicContext);\r\n\r\n    let boxes = this.prepareDataModel(this.data, this.removed, this.labels, this.graphicContext.palette,\r\n      this.domain, this.sortFunction);\r\n\r\n    boxes = boxes.filter(b => !b.hidden);\r\n\r\n    this.graphicContext = this.preparePane(boxes, this.lookAndFeel, this.graphicContext);\r\n\r\n    this.graphicContext = this.prepareScales(boxes, this.domain, this.lookAndFeel, this.graphicContext);\r\n\r\n    this.graphicContext = this.plotAxisBox(boxes, this.domain, this.lookAndFeel, this.mainPane, this.graphicContext);\r\n\r\n\r\n    this.graphicContext = this.plotDataBoxes(boxes, this.lookAndFeel, this.mainPane, this.graphicContext);\r\n\r\n    this.graphicContext = this.prepareTooltip(this.mainPane, this.graphicContext);\r\n\r\n    this.graphicContext = this.prepareLabels(boxes, this.mainPane, this.lookAndFeel, this.graphicContext, this.labelsOn);\r\n\r\n  }\r\n\r\n  prepareDataModel(data: number[][], removed: number[], labels: string[], palette: string[], domain: number[],\r\n                   sortFunction: (b1: BoxDefinition, b2: BoxDefinition) => number): BoxDefinition[] {\r\n\r\n    let boxes = this.boxUtil.dataToBoxes(data);\r\n\r\n    this.boxUtil.mockEmptyValues(boxes, domain[1]);\r\n    this.labelBoxes(boxes, labels);\r\n\r\n    this.colorBoxes(boxes, palette);\r\n\r\n    removed.forEach(ix => {\r\n      if (boxes[ix]) {\r\n        boxes[ix].hidden = true;\r\n      }\r\n    });\r\n\r\n    boxes = boxes.sort(sortFunction);\r\n    return boxes;\r\n\r\n  }\r\n\r\n\r\n  updatePalette(data: any[], palette: string[], graphicContext: GraphicContext): GraphicContext {\r\n\r\n    if (!palette || palette.length === 0) {\r\n      graphicContext.palette = BD2ColorPalette.palette(data.length);\r\n    } else {\r\n      graphicContext.palette = BD2ColorPalette.extendPalette(palette, data.length);\r\n\r\n    }\r\n    this.colors.next(graphicContext.palette.slice());\r\n\r\n    return graphicContext;\r\n  }\r\n\r\n  colorBoxes(boxes: BoxDefinition[], palette: string[]) {\r\n    boxes.forEach(b => b.color = palette[b.ix]);\r\n  }\r\n\r\n\r\n  preparePane(data: any[], lookAndFeel: LookAndFeel, graphicContext: GraphicContext): GraphicContext {\r\n\r\n    // console.log(\"PP\",data);\r\n\r\n    if (!this.mainPane) {\r\n      // let d3ParentElement = this.d3.select(this.parentNativeElement);\r\n      // this.d3Svg = d3ParentElement.select('.hbox-plot').append<SVGSVGElement>('svg');\r\n      this.d3Svg.attr('width', '100%');\r\n\r\n      this.mainPane = this.d3Svg.append<SVGGElement>('g');\r\n      this.mainPane.classed('mainPane', true);\r\n\r\n    }\r\n\r\n    const pWidth = 500;\r\n    const pHeight = this.calculateWorkspaceHeight(data, lookAndFeel) + 2 * lookAndFeel.vMargin;\r\n\r\n    const elm = (graphicContext.transitionOn ? this.d3Svg.transition(graphicContext.transition) : this.d3Svg);\r\n    elm.attr('viewBox', '0 0 ' + pWidth + ' ' + pHeight);\r\n    this.mainPane.attr('transform', 'translate(' + lookAndFeel.hMarginL + ',' + lookAndFeel.vMargin + ')');\r\n    // .attr('transform', 'translate(' + (pWidth / 2) + ',' + (pHeight / 2) + ')'); //moves 0,0 of the pain to the middle of the graphics\r\n\r\n    graphicContext.workspaceWidth = pWidth - lookAndFeel.hMarginL - lookAndFeel.hMarginR;\r\n    graphicContext.workspaceHeight = pHeight - 2 * lookAndFeel.vMargin;\r\n\r\n    return graphicContext;\r\n\r\n  }\r\n\r\n  calculateWorkspaceHeight(data: any[], lookAndFeel: LookAndFeel) {\r\n    return lookAndFeel.rowWidth * data.length;\r\n\r\n  }\r\n\r\n\r\n  labelBoxes(boxes: BoxDefinition[], labels: string[]) {\r\n    if (!labels) {\r\n      labels = [];\r\n    }\r\n\r\n\r\n    boxes.forEach((b, ix) => {\r\n      b.label = labels[ix] ? labels[ix] : '' + (ix + 1);\r\n    });\r\n  }\r\n\r\n  prepareLabels(boxes: BoxDefinition[], mainPane: Selection<SVGGElement, any, null, undefined>, lookAndFeel: LookAndFeel,\r\n                graphicContext: GraphicContext, labelsOn: string): GraphicContext {\r\n\r\n    if (!graphicContext.labelsWrapper) {\r\n      graphicContext.labelsWrapper = mainPane.append<SVGGElement>('g')\r\n        .classed('labelsWrapper', true);\r\n    }\r\n\r\n    if (!graphicContext.backLabelsWrapper) {\r\n      graphicContext.backLabelsWrapper = mainPane.insert<SVGGElement>('g', 'g.dataWrapper')\r\n        .classed('backLabelsWrapper', true);\r\n    }\r\n\r\n    const backLabelsOn = labelsOn === 'always';\r\n    const mainLabelsOn = labelsOn === 'always' || labelsOn === 'trigger';\r\n\r\n\r\n    const labels = graphicContext.labelsWrapper.selectAll('g.yLabel')\r\n      .data(mainLabelsOn ? boxes : [], (d: BoxDefinition) => d.key);\r\n\r\n    labels.exit().remove();\r\n\r\n    const newLabels = labels.enter()\r\n      .append<SVGGElement>('g')\r\n      .classed('yLabel', true);\r\n\r\n    this.ngZone.runOutsideAngular(() => {\r\n      newLabels.on('mouseover', function(evnt: MouseEvent, d: BoxDefinition) {\r\n        d3.select(this)\r\n          .selectAll('.yLabel')\r\n          // .style(\"visibility\", \"visible\");\r\n          .style('display', null);\r\n      }).on('mouseout', function() {\r\n        d3.select(this)\r\n          .selectAll('.yLabel')\r\n          // .style(\"visibility\", \"hidden\");\r\n          .style('display', 'none');\r\n      });\r\n    });\r\n\r\n    newLabels.append<SVGGElement>('rect')\r\n      .attr('class', 'yTrigger')\r\n      .style('fill-opacity', 1)\r\n    ;\r\n\r\n    newLabels.append<SVGGElement>('rect')\r\n      .attr('class', 'yLabel')\r\n      .style('fill-opacity', 0.35)\r\n      // .style(\"visibility\", \"hidden\");\r\n      .style('display', 'none');\r\n\r\n\r\n    newLabels.append<SVGGElement>('text')\r\n      .attr('class', 'yLabel')\r\n      .attr('text-anchor', 'left')\r\n      .attr('dominant-baseline', 'central')\r\n      .style('font-size', lookAndFeel.labelFont)\r\n      .style('opacity', 1)\r\n      .attr('x', 5)\r\n    // .style(\"visibility\", \"hidden\");\r\n    // .style(\"display\", \"none\");\r\n    ;\r\n\r\n    const backLabels = graphicContext.backLabelsWrapper.selectAll('g.yLabel')\r\n      .data(backLabelsOn ? boxes : [], (d: BoxDefinition) => d.key);\r\n\r\n    backLabels.exit().remove();\r\n\r\n    const newBackLabels = backLabels.enter()\r\n      .append<SVGGElement>('g')\r\n      .classed('yLabel', true);\r\n\r\n    /*\r\n     newBackLabels.append<SVGGElement>(\"rect\")\r\n     .attr(\"class\", \"yLabel\")\r\n     .style(\"fill-opacity\", 0.05);\r\n     */\r\n\r\n    newBackLabels.append<SVGGElement>('text')\r\n      .attr('class', 'yLabel')\r\n      .attr('text-anchor', 'left')\r\n      .attr('dominant-baseline', 'central')\r\n      .style('font-size', lookAndFeel.labelFont)\r\n      .style('opacity', lookAndFeel.backLabelOpacity)\r\n      .attr('x', 5);\r\n    // .style(\"visibility\", \"hidden\");\r\n\r\n\r\n    const enterUpdate: Selection<SVGSVGElement, BoxDefinition, null, undefined> =\r\n      newLabels.merge(labels as any) as Selection<SVGSVGElement, BoxDefinition, null, undefined>;\r\n\r\n    const backEnterUpdate: Selection<SVGSVGElement, BoxDefinition, null, undefined> =\r\n      newBackLabels.merge(backLabels as any) as Selection<SVGSVGElement, BoxDefinition, null, undefined>;\r\n\r\n    // called with delay to allow, parent divs to component sets their visibility, otherwise the bboxes cannot be calculated\r\n    // and the labels backgrounds and trigers are not rendered correctly\r\n    // it is a hack, but don't know how to do it correctly\r\n    // timers have to be cleared as otherwise saw errors in logs for fast changing input data (like cause by sorting and pagination)\r\n    graphicContext.labelsTimers.forEach( timer => clearTimeout(timer));\r\n    graphicContext.labelsTimers = [];\r\n    const timer = setTimeout(() => {\r\n\r\n\r\n      const bboxes: SVGRect[] = [];\r\n\r\n      enterUpdate.select<SVGSVGElement>('text')\r\n        .style('display', null)\r\n        .attr('y', d => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth() / 2)\r\n        .text(d => d.label)\r\n        .each(function(d) {\r\n          bboxes.push(this.getBBox());\r\n          // console.log(\"D: \" + d.label, this.getBBox());\r\n        })\r\n        .style('display', 'none');\r\n\r\n\r\n      let elm = backEnterUpdate.select<SVGSVGElement>('text');\r\n      elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n      elm\r\n        .attr('y', d => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth() / 2)\r\n        .text(d => d.label)\r\n      // .style(\"fill\", d => d.color)\r\n      /*.each(function (d) {\r\n       bboxes.push(this.getBBox());\r\n       //console.log(\"D: \" + d.label, this.getBBox());\r\n       });*/\r\n      ;\r\n\r\n      const trigers = enterUpdate.select<SVGSVGElement>('.yTrigger')\r\n        .style('fill', d => d.color)\r\n        .style('stroke', d => d.color);\r\n\r\n\r\n      let telm = trigers.data(bboxes);\r\n      telm = (graphicContext.transitionOn ? telm.transition(graphicContext.transition) : telm) as any;\r\n      telm\r\n        .attr('x', -7)\r\n        .attr('y', b => b.y - 3)\r\n        .attr('width', b => 7)\r\n        .attr('height', b => b.height + 6);\r\n\r\n      const frames = enterUpdate.select<SVGSVGElement>('rect.yLabel')\r\n        .style('fill', d => d.color)\r\n        .style('fill-opacity', lookAndFeel.labelFillOpacity);\r\n\r\n      frames.data(bboxes)\r\n        .attr('x', 0)\r\n        .attr('y', b => b.y - 3)\r\n        .attr('width', b => b.width + 10)\r\n        .attr('height', b => b.height + 7);\r\n\r\n\r\n      /*\r\n       let backFrames = backEnterUpdate.select<SVGSVGElement>(\"rect.yLabel\")\r\n       .style(\"fill\", d => d.color);\r\n\r\n       backFrames.data(bboxes)\r\n       .attr(\"x\", 0)\r\n       .attr(\"y\", b => b.y - 3)\r\n       .attr(\"width\", b => b.width + 10)\r\n       .attr(\"height\", b => b.height + 7);\r\n       */\r\n\r\n    }, 10);\r\n\r\n    graphicContext.labelsTimers.push(timer);\r\n    return graphicContext;\r\n  }\r\n\r\n\r\n  prepareTooltip(mainPane: Selection<SVGGElement, any, null, undefined>, graphicContext: GraphicContext): GraphicContext {\r\n\r\n    if (graphicContext.tooltipWrapper) {\r\n      return graphicContext;\r\n    }\r\n\r\n    graphicContext.tooltipWrapper = mainPane.append<SVGGElement>('g')\r\n      .classed('tooltipWrapper', true);\r\n\r\n    graphicContext.tooltipBox = graphicContext.tooltipWrapper.append<SVGGElement>('rect')\r\n      .style('fill', 'white')\r\n      .style('fill-opacity', 0.8)\r\n      .style('stroke', 'grey')\r\n    // .style(\"visibility\", \"hidden\");\r\n    ;\r\n\r\n    graphicContext.tooltipText = graphicContext.tooltipWrapper.append<SVGGElement>('text')\r\n      .attr('class', 'tooltip')\r\n      // .attr(\"text-anchor\", \"left\")\r\n      .attr('text-anchor', 'middle')\r\n      // .attr(\"alignment-baseline\", \"middle\")\r\n      // .attr(\"alignment-baseline\", \"baseline\")\r\n      // .attr(\"dy\", \"-10px\")\r\n      .style('opacity', 1)\r\n    // .attr(\"dx\", \"0.35em\")\r\n    // .style(\"font-size\", this.lookAndFeel.tooltipFontSize) //\"11px\")\r\n    // .style(\"opacity\", 0)\r\n    ;\r\n\r\n    graphicContext.tooltipWrapper\r\n    // .style(\"visibility\", \"hidden\");\r\n      .style('display', 'none');\r\n\r\n    return graphicContext;\r\n  }\r\n\r\n  showTooltip(v: number, x: any, y: any) {\r\n    // console.log(\"Show: \" + v + \";\" + this.constructor.name);\r\n    // console.log('Show: ' + v + '; ' + x + ': ' + y);\r\n    // console.log('v', SmartRounder.round(v));\r\n    // console.log('x', this.graphicContext.xScale(x));\r\n    // console.log('y', this.graphicContext.yScale(y));\r\n\r\n    if (!this.graphicContext.tooltipText) {\r\n      return;\r\n    }\r\n\r\n    this.graphicContext.tooltipText\r\n      .attr('x', this.graphicContext.xScale(x))\r\n      .attr('y', this.graphicContext.yScale(y))\r\n      .text(SmartRounder.round(v))\r\n    // .transition().duration(this.lookAndFeel.baseTransitionsTime / 2)\r\n    // .style('opacity', 1);\r\n    ;\r\n\r\n    // I have to change the display here even before the box is ready as\r\n    // in firefox the getBBox was not working if called with display none\r\n    // giving NS_ERROR_FAILURE 2147500037\r\n    this.graphicContext.tooltipWrapper\r\n      // .style(\"visibility\", \"visible\");\r\n      .style('display', null);\r\n\r\n    const bbox = this.graphicContext.tooltipText.node().getBBox();\r\n\r\n    this.graphicContext.tooltipBox\r\n      .attr('x', bbox.x - 3)\r\n      .attr('y', bbox.y - 2)\r\n      .attr('width', bbox.width + 6)\r\n      .attr('height', bbox.height + 4);\r\n\r\n\r\n\r\n\r\n  }\r\n\r\n  hideTooltip() {\r\n    // console.log(\"Hide: \");\r\n    if (!this.graphicContext.tooltipText) {\r\n      return;\r\n    }\r\n\r\n\r\n    this.graphicContext.tooltipWrapper\r\n    // .style(\"visibility\", \"hidden\");\r\n      .style('display', 'none');\r\n\r\n\r\n    // this.graphicContext.tooltipText\r\n    // .transition().duration(this.lookAndFeel.baseTransitionsTime / 2)\r\n    // .style(\"opacity\", 0);\r\n  }\r\n\r\n  prepareScales(data: BoxDefinition[], domain: number[], lookAndFeel: LookAndFeel,\r\n                graphicContext: GraphicContext): GraphicContext {\r\n\r\n    if (!graphicContext.xScale) {\r\n      graphicContext.xScale = d3.scaleLinear()\r\n        .clamp(true);\r\n    }\r\n\r\n    graphicContext.xScale\r\n      .domain(domain)\r\n      .range([0, graphicContext.workspaceWidth]);\r\n\r\n    if (!graphicContext.yScale) {\r\n      graphicContext.yScale = d3.scaleBand()\r\n        .padding(lookAndFeel.rowGap)\r\n      ;\r\n    }\r\n\r\n    const domainY = data.map((d) => d.key);\r\n\r\n    graphicContext.yScale\r\n      .domain(domainY)\r\n      .range([0, graphicContext.workspaceHeight]);\r\n\r\n\r\n    return graphicContext;\r\n  }\r\n\r\n  plotAxisBox(data: BoxDefinition[], domain: number[], lookAndFeel: LookAndFeel, mainPane: Selection<SVGGElement, any, null, undefined>,\r\n              graphicContext: GraphicContext): GraphicContext {\r\n\r\n    if (!graphicContext.axisWrapper) {\r\n      graphicContext.axisWrapper = this.initAxisWrapper(mainPane);\r\n    }\r\n\r\n    graphicContext = this.plotHorizontalScales(domain, lookAndFeel, graphicContext);\r\n    graphicContext = this.plotVerticalScales(data, lookAndFeel, graphicContext);\r\n\r\n    return graphicContext;\r\n\r\n  }\r\n\r\n  initAxisWrapper(mainPane: Selection<SVGGElement, any, null, undefined>): Selection<SVGGElement, any, null, undefined> {\r\n\r\n    let wrapper = mainPane.select<SVGGElement>('.axisWrapper');\r\n    if (wrapper.size() === 0) {\r\n      wrapper = mainPane.append<SVGGElement>('g').attr('class', 'axisWrapper');\r\n\r\n      wrapper.append('g').attr('class', 'xTopAxis');\r\n      wrapper.append('g').attr('class', 'xBottomAxis');\r\n      wrapper.append('g').attr('class', 'yLeftAxis');\r\n      wrapper.append('g').attr('class', 'yRightAxis');\r\n\r\n    }\r\n    return wrapper;\r\n  }\r\n\r\n  plotHorizontalScales(domain: number[], lookAndFeel: LookAndFeel, graphicContext: GraphicContext): GraphicContext {\r\n\r\n\r\n    if (!graphicContext.xTopAxis) {\r\n      graphicContext.xTopAxis = d3.axisTop(graphicContext.xScale);\r\n    }\r\n\r\n    if (!graphicContext.xBottomAxis) {\r\n      graphicContext.xBottomAxis = d3.axisBottom(graphicContext.xScale);\r\n    }\r\n\r\n\r\n    let elmT = graphicContext.axisWrapper.select('g.xTopAxis')  as any;\r\n    elmT.call(graphicContext.xTopAxis);\r\n\r\n    let elmB = graphicContext.axisWrapper.select('g.xBottomAxis') as any;\r\n    elmB = (graphicContext.transitionOn ? elmB.transition(graphicContext.transition) : elmB);\r\n    elmB\r\n      .attr('transform', 'translate(0,' + graphicContext.workspaceHeight + ')')\r\n      .call(graphicContext.xBottomAxis);\r\n\r\n    return graphicContext;\r\n\r\n  }\r\n\r\n  plotVerticalScales(data: BoxDefinition[], lookAndFeel: LookAndFeel, graphicContext: GraphicContext): GraphicContext {\r\n\r\n\r\n    if (!graphicContext.yLeftAxis) {\r\n      graphicContext.yLeftAxis = d3.axisLeft(graphicContext.yScale)\r\n        .tickFormat(() => '')\r\n      ;\r\n    }\r\n\r\n    if (!graphicContext.yRightAxis) {\r\n      graphicContext.yRightAxis = d3.axisRight(graphicContext.yScale)\r\n        .tickValues([])\r\n      ;\r\n    }\r\n\r\n    let elm = graphicContext.axisWrapper.select('g.yLeftAxis') as any;\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm);\r\n    elm\r\n      .call(graphicContext.yLeftAxis);\r\n\r\n\r\n    elm = graphicContext.axisWrapper.select('g.yRightAxis')\r\n      .attr('transform', 'translate(' + graphicContext.workspaceWidth + ',0)') as any;\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm);\r\n    elm\r\n      .call(graphicContext.yRightAxis);\r\n\r\n    return graphicContext;\r\n\r\n  }\r\n\r\n\r\n  plotDataBoxes(boxes: BoxDefinition[], lookAndFeel: LookAndFeel, mainPane: Selection<SVGGElement, any, null, undefined>,\r\n                graphicContext: GraphicContext): GraphicContext {\r\n\r\n    if (!graphicContext.dataWrapper) {\r\n      graphicContext.dataWrapper = mainPane.append<SVGGElement>('g').attr('class', 'dataWrapper');\r\n    }\r\n\r\n\r\n\r\n    let boxWidgets = graphicContext.dataWrapper.selectAll('.boxWidget') as Selection<SVGGElement, BoxDefinition, null, undefined>;\r\n\r\n    boxWidgets = boxWidgets.data(boxes, d => d.key);\r\n\r\n\r\n    this.updateBoxWidgets(boxWidgets, lookAndFeel, graphicContext);\r\n\r\n    const newBoxWidgets = boxWidgets.enter()\r\n      .append<SVGGElement>('g').attr('class', 'boxWidget');\r\n\r\n\r\n    this.createBoxWidgets(newBoxWidgets, lookAndFeel, graphicContext);\r\n\r\n    boxWidgets.exit().remove();\r\n\r\n\r\n    return graphicContext;\r\n  }\r\n\r\n  updateBoxWidgets(boxWidgets: Selection<SVGGElement, BoxDefinition, null, undefined>,\r\n                   lookAndFeel: LookAndFeel, graphicContext: GraphicContext) {\r\n\r\n    // this.ngZone.runOutsideAngular(() => {\r\n\r\n    boxWidgets.select('rect.backdrop')\r\n      .call(this.positionBackdrop, graphicContext);\r\n\r\n    this.updateWhiskers(boxWidgets.select('g.whiskers') as any, graphicContext);\r\n\r\n    boxWidgets.select('g.box rect')\r\n      .call(this.positionBoxRectangle, graphicContext);\r\n\r\n    boxWidgets.select('g.box line.medianline')\r\n      .call(this.positionMedianLine, graphicContext);\r\n\r\n    boxWidgets.select('g.box line.meanline')\r\n      .call(this.positionMeanLine, graphicContext);\r\n\r\n    const out = boxWidgets.select('g.outliers').selectAll('.outlier')\r\n      .data(d => d.outliers.map(x => [x, d.key, d.color]));\r\n\r\n    out.enter()\r\n      .call(this.createOutlier, lookAndFeel, graphicContext, this.positionOutlier);\r\n\r\n    out.call(this.positionOutlier, graphicContext);\r\n\r\n    out.exit().remove();\r\n\r\n    // });\r\n\r\n  }\r\n\r\n\r\n  positionBackdrop(elm: Selection<SVGGElement, BoxDefinition, null, undefined>, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm\r\n      .attr('x', (d) => offsetScaleValue(d.lowWskr, -5, graphicContext.xScale))\r\n      .attr('y', (d) => {\r\n        return graphicContext.yScale(d.key);\r\n      })\r\n      .attr('width', (d) => {\r\n        const x1 = offsetScaleValue(d.lowWskr, -5, graphicContext.xScale);\r\n        const x2 = offsetScaleValue(d.highWskr, +5, graphicContext.xScale);\r\n        return x2 - x1;\r\n      })\r\n      .attr('height', (d) => {\r\n        return graphicContext.yScale.bandwidth();\r\n      })\r\n    // .style(\"stroke\", d => d.color)\r\n    // .style(\"fill\", d => d.color)\r\n    ;\r\n\r\n  }\r\n\r\n  positionBoxRectangle(elm: Selection<SVGGElement, BoxDefinition, null, undefined>, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm\r\n      .attr('x', (d) => graphicContext.xScale(d.fstQnt))\r\n      .attr('y', (d) => {\r\n        return graphicContext.yScale(d.key);\r\n      })\r\n      .attr('width', (d) => (graphicContext.xScale(d.thrdQnt) - graphicContext.xScale(d.fstQnt)))\r\n      .attr('height', (d) => {\r\n        return graphicContext.yScale.bandwidth();\r\n      })\r\n      .style('stroke', d => d.color)\r\n      .style('fill', d => d.color);\r\n\r\n  }\r\n\r\n  positionMedianLine(elm: Selection<SVGGElement, BoxDefinition, null, undefined>, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm\r\n      .attr('x1', (d, i) => graphicContext.xScale(d.median))\r\n      .attr('y1', (d, i) => graphicContext.yScale(d.key))\r\n      .attr('x2', (d, i) => graphicContext.xScale(d.median))\r\n      .attr('y2', (d, i) => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth())\r\n      .style('stroke', d => d.color)\r\n      // .style(\"visibility\", d => d.mean === d.median ? \"hidden\" : \"visible\");\r\n      .style('display', d => d.mean === d.median ? 'none' : null);\r\n\r\n\r\n\r\n  }\r\n\r\n  positionMeanLine(elm: Selection<SVGGElement, BoxDefinition, null, undefined>, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm\r\n      .attr('x1', (d, i) => graphicContext.xScale(d.mean))\r\n      .attr('y1', (d, i) => graphicContext.yScale(d.key))\r\n      .attr('x2', (d, i) => graphicContext.xScale(d.mean))\r\n      .attr('y2', (d, i) => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth())\r\n      .style('stroke', d => d.color);\r\n  }\r\n\r\n  positionOutlier(elm: Selection<SVGGElement, any, null, undefined>, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm.attr('cx', d => graphicContext.xScale(d[0]))\r\n      .attr('cy', d => graphicContext.yScale(d[1]) + graphicContext.yScale.bandwidth() / 2)\r\n      .style('stroke', d => d[2])\r\n      .style('fill', d => d[2]);\r\n\r\n  }\r\n\r\n\r\n  createOutlier(elm: Selection<SVGGElement, any, null, undefined>, lookAndFeel: LookAndFeel, graphicContext: GraphicContext,\r\n                positionOutlierFunction: (elm: Selection<SVGGElement, any, null, undefined>, graphicContext: GraphicContext) => {}) {\r\n\r\n\r\n    elm\r\n      .append<SVGGElement>('circle')\r\n      .attr('class', 'outlier')\r\n      .attr('r', lookAndFeel.outliersCircleRadius)\r\n      .style('stroke-width', lookAndFeel.outliersStrokeWidth)\r\n      .style('fill-opacity', lookAndFeel.outliersFillOpacity)\r\n      .call(positionOutlierFunction, graphicContext)\r\n    ;\r\n\r\n  }\r\n\r\n  positionWhiskerLine(elm: Selection<SVGGElement, BoxDefinition, null, undefined>, left: boolean, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm\r\n      .attr('x1', (d, i) => left ? graphicContext.xScale(d.lowWskr) : graphicContext.xScale(d.thrdQnt))\r\n      .attr('y1', (d, i) => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth() / 2)\r\n      .attr('x2', (d, i) => left ? graphicContext.xScale(d.fstQnt) : graphicContext.xScale(d.highWskr))\r\n      .attr('y2', (d, i) => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth() / 2)\r\n      .style('stroke', d => d.color)\r\n      // .style(\"visibility\", d => (left && (d.lowWskr === d.fstQnt)) || (!left && (d.highWskr === d.thrdQnt)) ? \"hidden\" : \"visible\");\r\n      .style('display', d => (left && (d.lowWskr === d.fstQnt)) || (!left && (d.highWskr === d.thrdQnt)) ? 'none' : null);\r\n\r\n\r\n  }\r\n\r\n  positionWhiskerTip(elm: Selection<SVGGElement, BoxDefinition, null, undefined>, left: boolean, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm\r\n      .attr('x1', (d, i) => left ? graphicContext.xScale(d.lowWskr) : graphicContext.xScale(d.highWskr))\r\n      .attr('y1', (d, i) => graphicContext.yScale(d.key))\r\n      .attr('x2', (d, i) => left ? graphicContext.xScale(d.lowWskr) : graphicContext.xScale(d.highWskr))\r\n      .attr('y2', (d, i) => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth())\r\n      .style('stroke', d => d.color)\r\n      // .style(\"visibility\", d => (left && (d.lowWskr === d.fstQnt)) || (!left && (d.highWskr === d.thrdQnt)) ? \"hidden\" : \"visible\");\r\n      .style('display', d => (left && (d.lowWskr === d.fstQnt)) || (!left && (d.highWskr === d.thrdQnt)) ? 'none' : null);\r\n\r\n\r\n\r\n  }\r\n\r\n  updateWhiskers(whiskers: Selection<SVGGElement, BoxDefinition, null, undefined>,\r\n                 graphicContext: GraphicContext) {\r\n\r\n    whiskers.select('line.whiskerlineL')\r\n      .call(this.positionWhiskerLine, true, graphicContext);\r\n\r\n    whiskers.select('line.whiskerlineR')\r\n      .call(this.positionWhiskerLine, false, graphicContext);\r\n\r\n    whiskers.select('line.whiskertipL')\r\n      .call(this.positionWhiskerTip, true, graphicContext);\r\n\r\n    whiskers.select('line.whiskertipR')\r\n      .call(this.positionWhiskerTip, false, graphicContext);\r\n\r\n  }\r\n\r\n  createWhiskers(whiskers: Selection<SVGGElement, BoxDefinition, null, undefined>,\r\n                 lookAndFeel: LookAndFeel, graphicContext: GraphicContext) {\r\n\r\n\r\n    const lwhiskr = whiskers.append('line')\r\n      .attr('class', 'whiskerlineL')\r\n      .style('stroke-width', lookAndFeel.whiskerStrokeWidth)\r\n      .style('stroke-dasharray', '4 3')\r\n      .call(this.positionWhiskerLine, true, graphicContext)\r\n    ;\r\n    const rwhiskr = whiskers.append('line')\r\n      .attr('class', 'whiskerlineR')\r\n      .style('stroke-width', lookAndFeel.whiskerStrokeWidth)\r\n      .style('stroke-dasharray', '4 3')\r\n      .call(this.positionWhiskerLine, false, graphicContext)\r\n    ;\r\n\r\n    const lTip = whiskers.append('line')\r\n      .attr('class', 'whiskertipL')\r\n      .style('stroke-width', lookAndFeel.whiskerStrokeWidth)\r\n      .call(this.positionWhiskerTip, true, graphicContext)\r\n    ;\r\n\r\n    const rTip = whiskers.append('line')\r\n      .attr('class', 'whiskertipR')\r\n      .style('stroke-width', lookAndFeel.whiskerStrokeWidth)\r\n      .call(this.positionWhiskerTip, false, graphicContext)\r\n    ;\r\n\r\n\r\n  }\r\n\r\n  createBoxes(widgets: Selection<SVGGElement, BoxDefinition, null, undefined>,\r\n              lookAndFeel: LookAndFeel, graphicContext: GraphicContext) {\r\n\r\n\r\n    const rect = widgets.append('rect')\r\n      .attr('class', 'box')\r\n      .style('stroke-width', lookAndFeel.boxStrokeWidth)\r\n      .style('fill-opacity', lookAndFeel.boxFillOpacity)\r\n      .call(this.positionBoxRectangle, graphicContext);\r\n\r\n\r\n    const median = widgets.append('line')\r\n      .attr('class', 'medianline')\r\n      .style('stroke-width', lookAndFeel.boxStrokeWidth)\r\n      .call(this.positionMedianLine, graphicContext);\r\n\r\n    const instance = this;\r\n\r\n    this.ngZone.runOutsideAngular(() => {\r\n      rect.on('mouseover', function(evnt: MouseEvent, d: BoxDefinition) {\r\n        instance.showTooltip(d.median, d.median, d.key);\r\n      })\r\n        .on('mouseout', function() {\r\n          instance.hideTooltip();\r\n        });\r\n\r\n      median.on('mouseover', function(evnt: MouseEvent, d: BoxDefinition) {\r\n        instance.showTooltip(d.median, d.median, d.key);\r\n      })\r\n        .on('mouseout', function() {\r\n          instance.hideTooltip();\r\n        });\r\n\r\n    });\r\n\r\n    const mean = widgets\r\n      .append('line')\r\n      .attr('class', 'meanline')\r\n      .style('stroke-width', lookAndFeel.meanStrokeWidth)\r\n      .style('stroke-dasharray', '4 2')\r\n      .call(this.positionMeanLine, graphicContext)\r\n    ;\r\n\r\n    // has to be outside angular, to prevent detection\r\n    this.ngZone.runOutsideAngular(() => {\r\n      mean\r\n        .on('mouseover', function(evnt: MouseEvent, d: BoxDefinition) {\r\n          instance.showTooltip(d.mean, d.mean, d.key);\r\n        })\r\n        .on('mouseout', function() {\r\n          instance.hideTooltip();\r\n        });\r\n\r\n    });\r\n\r\n  }\r\n\r\n  createBoxWidgets(newBoxWidgets: Selection<SVGGElement, BoxDefinition, null, undefined>,\r\n                   lookAndFeel: LookAndFeel, graphicContext: GraphicContext) {\r\n\r\n    // this.ngZone.runOutsideAngular(() => {\r\n\r\n    const instance = this;\r\n\r\n    const backdrops = newBoxWidgets.append<SVGGElement>('rect').attr('class', 'backdrop')\r\n    // .style(\"stroke-width\", lookAndFeel.boxStrokeWidth)\r\n      .style('fill-opacity', lookAndFeel.backdropOpacity)\r\n      .style('fill', lookAndFeel.backdropColor)\r\n      .call(this.positionBackdrop, graphicContext);\r\n\r\n\r\n    const whiskers = newBoxWidgets.append<SVGGElement>('g').attr('class', 'whiskers');\r\n\r\n    this.createWhiskers(whiskers, lookAndFeel, graphicContext);\r\n\r\n    const boxes = newBoxWidgets.append<SVGGElement>('g').attr('class', 'box');\r\n    this.createBoxes(boxes, lookAndFeel, graphicContext);\r\n\r\n\r\n    const outliers = newBoxWidgets.append<SVGGElement>('g').attr('class', 'outliers');\r\n\r\n\r\n    outliers.selectAll('.outlier')\r\n      .data(d => d.outliers.map(x => [x, d.key, d.color]))\r\n      .enter()\r\n      .call(this.createOutlier, lookAndFeel, graphicContext, this.positionOutlier)\r\n    ;\r\n\r\n    // });\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\nimport {HBoxPlotComponent} from './hbox-plot/hbox-plot.component';\n\n\n\n@NgModule({\n  declarations: [HBoxPlotComponent],\n  imports: [\n  ],\n  exports: [HBoxPlotComponent]\n})\nexport class BD2NgxHBoxplotModule { }\n","/*\n * Public API Surface of bd2-ngx-hboxplot\n */\n\nexport * from './lib/hbox-plot/hbox-plot.component';\nexport * from './lib/bd2-ngx-hboxplot.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["interval","take","i0","AppComponent","constructor","testData","nr","Math","random","row","i","push","generateData","toggleRemoved","removed","length","toggleHidden","isHidden","toggleSorted","sorted","toggleLabels","labelsOn","generateDelayedData","s","pipe","subscribe","v","generateDataInner","err","unsubscribe","nrBase","ci","d","ix","round","base","map","LET","labels","label","data","detection","console","log","selectors","decls","vars","consts","template","ctx","BrowserModule","BD2NgxHBoxplotModule","AppModule","bootstrap","declarations","imports","environment","production","enableProdMode","__NgCli_bootstrap_1","bootstrapModule","catch","error","d3","d3lib","LookAndFeel","defualtLookAndFeel","GraphicContext","offsetScaleValue","x","pixOffset","scale","r","range","pos","BoxDefinition","BoxUtil","dataToBoxes","b","datumToBox","key","box","sort","ascending","mean","median","fstQnt","quantile","thrdQnt","iqr","lowWskr","highWskr","outliers","filter","mockEmptyValues","boxes","missingVal","forEach","undefined","BD2ColorPalette","extendPalette","palette","size","out","schemeCategory10","schemeCategory20","SmartRounder","value","abs","HBoxPlotComponent","sorting","sortFunction","b1","b2","ngZone","changeDetectorRef","element","EventEmitter","parentNativeElement","nativeElement","ngAfterViewInit","detach","ngOnChanges","changes","detectChanges","initSVG","sortChanged","hidden","updatePlot","isDataUpdate","domain","d3Svg","d3ParentElement","select","append","attr","ngOnInit","ngOnDestroy","empty","selectAll","remove","testGraphicContext","context","graphicContext","lookAndFeel","transitionTime","transitionOn","runOutsideAngular","transition","duration","updatePalette","prepareDataModel","preparePane","prepareScales","plotAxisBox","mainPane","plotDataBoxes","prepareTooltip","prepareLabels","boxUtil","labelBoxes","colorBoxes","colors","next","slice","color","classed","pWidth","pHeight","calculateWorkspaceHeight","vMargin","elm","hMarginL","workspaceWidth","hMarginR","workspaceHeight","rowWidth","labelsWrapper","backLabelsWrapper","insert","backLabelsOn","mainLabelsOn","exit","newLabels","enter","on","evnt","style","labelFont","backLabels","newBackLabels","backLabelOpacity","enterUpdate","merge","backEnterUpdate","labelsTimers","timer","clearTimeout","setTimeout","bboxes","yScale","bandwidth","text","each","getBBox","trigers","telm","y","height","frames","labelFillOpacity","width","tooltipWrapper","tooltipBox","tooltipText","showTooltip","xScale","bbox","node","hideTooltip","scaleLinear","clamp","scaleBand","padding","rowGap","domainY","axisWrapper","initAxisWrapper","plotHorizontalScales","plotVerticalScales","wrapper","xTopAxis","axisTop","xBottomAxis","axisBottom","elmT","call","elmB","yLeftAxis","axisLeft","tickFormat","yRightAxis","axisRight","tickValues","dataWrapper","boxWidgets","updateBoxWidgets","newBoxWidgets","createBoxWidgets","positionBackdrop","updateWhiskers","positionBoxRectangle","positionMedianLine","positionMeanLine","createOutlier","positionOutlier","x1","x2","positionOutlierFunction","outliersCircleRadius","outliersStrokeWidth","outliersFillOpacity","positionWhiskerLine","left","positionWhiskerTip","whiskers","createWhiskers","lwhiskr","whiskerStrokeWidth","rwhiskr","lTip","rTip","createBoxes","widgets","rect","boxStrokeWidth","boxFillOpacity","instance","meanStrokeWidth","backdrops","backdropOpacity","backdropColor","inputs","outputs","features","Component","args","selector","changeDetection","OnPush","styles","Input","Output","NgModule","exports"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}